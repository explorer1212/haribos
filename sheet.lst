     1 00000000                                 [FORMAT "WCOFF"]
     2 00000000                                 [INSTRSET "i486p"]
     3 00000000                                 [OPTIMIZE 1]
     4 00000000                                 [OPTION 1]
     5 00000000                                 [BITS 32]
     6 00000000                                 	EXTERN	_memman_alloc_4k
     7 00000000                                 	EXTERN	_memman_free_4k
     8 00000000                                 [FILE "sheet.c"]
     9                                          [SECTION .text]
    10 00000000                                 	GLOBAL	_shtctl_init
    11 00000000                                 _shtctl_init:
    12 00000000 55                              	PUSH	EBP
    13 00000001 89 E5                           	MOV	EBP,ESP
    14 00000003 57                              	PUSH	EDI
    15 00000004 56                              	PUSH	ESI
    16 00000005 53                              	PUSH	EBX
    17 00000006 8B 75 08                        	MOV	ESI,DWORD [8+EBP]
    18 00000009 68 00002C14                     	PUSH	11284
    19 0000000E 8B 7D 10                        	MOV	EDI,DWORD [16+EBP]
    20 00000011 56                              	PUSH	ESI
    21 00000012 E8 [00000000]                   	CALL	_memman_alloc_4k
    22 00000017 89 C3                           	MOV	EBX,EAX
    23 00000019 58                              	POP	EAX
    24 0000001A 5A                              	POP	EDX
    25 0000001B 85 DB                           	TEST	EBX,EBX
    26 0000001D 74 4A                           	JE	L3
    27 0000001F 8B 45 14                        	MOV	EAX,DWORD [20+EBP]
    28 00000022 0F AF C7                        	IMUL	EAX,EDI
    29 00000025 50                              	PUSH	EAX
    30 00000026 56                              	PUSH	ESI
    31 00000027 E8 [00000000]                   	CALL	_memman_alloc_4k
    32 0000002C 85 C0                           	TEST	EAX,EAX
    33 0000002E 89 43 04                        	MOV	DWORD [4+EBX],EAX
    34 00000031 5A                              	POP	EDX
    35 00000032 59                              	POP	ECX
    36 00000033 74 3E                           	JE	L11
    37 00000035 8B 45 0C                        	MOV	EAX,DWORD [12+EBP]
    38 00000038 89 7B 08                        	MOV	DWORD [8+EBX],EDI
    39 0000003B 89 03                           	MOV	DWORD [EBX],EAX
    40 0000003D 8D 93 000027D8                  	LEA	EDX,DWORD [10200+EBX]
    41 00000043 8B 45 14                        	MOV	EAX,DWORD [20+EBP]
    42 00000046 89 43 0C                        	MOV	DWORD [12+EBX],EAX
    43 00000049 89 D8                           	MOV	EAX,EBX
    44 0000004B C7 43 10 FFFFFFFF               	MOV	DWORD [16+EBX],-1
    45 00000052                                 L9:
    46 00000052 C7 80 00000430 00000000         	MOV	DWORD [1072+EAX],0
    47 0000005C 89 98 00000434                  	MOV	DWORD [1076+EAX],EBX
    48 00000062 83 C0 28                        	ADD	EAX,40
    49 00000065 39 D0                           	CMP	EAX,EDX
    50 00000067 7E E9                           	JLE	L9
    51 00000069                                 L3:
    52 00000069 8D 65 F4                        	LEA	ESP,DWORD [-12+EBP]
    53 0000006C 89 D8                           	MOV	EAX,EBX
    54 0000006E 5B                              	POP	EBX
    55 0000006F 5E                              	POP	ESI
    56 00000070 5F                              	POP	EDI
    57 00000071 5D                              	POP	EBP
    58 00000072 C3                              	RET
    59 00000073                                 L11:
    60 00000073 68 00002C14                     	PUSH	11284
    61 00000078 53                              	PUSH	EBX
    62 00000079 56                              	PUSH	ESI
    63 0000007A E8 [00000000]                   	CALL	_memman_free_4k
    64 0000007F 83 C4 0C                        	ADD	ESP,12
    65 00000082 EB E5                           	JMP	L3
    66 00000084                                 	GLOBAL	_sheet_alloc
    67 00000084                                 _sheet_alloc:
    68 00000084 55                              	PUSH	EBP
    69 00000085 31 D2                           	XOR	EDX,EDX
    70 00000087 89 E5                           	MOV	EBP,ESP
    71 00000089 8B 45 08                        	MOV	EAX,DWORD [8+EBP]
    72 0000008C 05 00000414                     	ADD	EAX,1044
    73 00000091                                 L18:
    74 00000091 83 78 1C 00                     	CMP	DWORD [28+EAX],0
    75 00000095 74 10                           	JE	L21
    76 00000097 42                              	INC	EDX
    77 00000098 83 C0 28                        	ADD	EAX,40
    78 0000009B 81 FA 000000FF                  	CMP	EDX,255
    79 000000A1 7E EE                           	JLE	L18
    80 000000A3 31 C0                           	XOR	EAX,EAX
    81 000000A5                                 L12:
    82 000000A5 5D                              	POP	EBP
    83 000000A6 C3                              	RET
    84 000000A7                                 L21:
    85 000000A7 C7 40 1C 00000001               	MOV	DWORD [28+EAX],1
    86 000000AE C7 40 18 FFFFFFFF               	MOV	DWORD [24+EAX],-1
    87 000000B5 C7 40 24 00000000               	MOV	DWORD [36+EAX],0
    88 000000BC EB E7                           	JMP	L12
    89 000000BE                                 	GLOBAL	_sheet_setbuf
    90 000000BE                                 _sheet_setbuf:
    91 000000BE 55                              	PUSH	EBP
    92 000000BF 89 E5                           	MOV	EBP,ESP
    93 000000C1 8B 55 08                        	MOV	EDX,DWORD [8+EBP]
    94 000000C4 8B 45 0C                        	MOV	EAX,DWORD [12+EBP]
    95 000000C7 89 02                           	MOV	DWORD [EDX],EAX
    96 000000C9 8B 45 10                        	MOV	EAX,DWORD [16+EBP]
    97 000000CC 89 42 04                        	MOV	DWORD [4+EDX],EAX
    98 000000CF 8B 45 14                        	MOV	EAX,DWORD [20+EBP]
    99 000000D2 89 42 08                        	MOV	DWORD [8+EDX],EAX
   100 000000D5 8B 45 18                        	MOV	EAX,DWORD [24+EBP]
   101 000000D8 89 42 14                        	MOV	DWORD [20+EDX],EAX
   102 000000DB 5D                              	POP	EBP
   103 000000DC C3                              	RET
   104 000000DD                                 	GLOBAL	_sheet_refreshsub
   105 000000DD                                 _sheet_refreshsub:
   106 000000DD 55                              	PUSH	EBP
   107 000000DE 89 E5                           	MOV	EBP,ESP
   108 000000E0 57                              	PUSH	EDI
   109 000000E1 56                              	PUSH	ESI
   110 000000E2 53                              	PUSH	EBX
   111 000000E3 83 EC 54                        	SUB	ESP,84
   112 000000E6 8B 45 08                        	MOV	EAX,DWORD [8+EBP]
   113 000000E9 8B 55 08                        	MOV	EDX,DWORD [8+EBP]
   114 000000EC 83 7D 0C 00                     	CMP	DWORD [12+EBP],0
   115 000000F0 8B 00                           	MOV	EAX,DWORD [EAX]
   116 000000F2 8B 52 04                        	MOV	EDX,DWORD [4+EDX]
   117 000000F5 89 45 C4                        	MOV	DWORD [-60+EBP],EAX
   118 000000F8 89 55 C0                        	MOV	DWORD [-64+EBP],EDX
   119 000000FB 0F 88 000003B2                  	JS	L90
   120 00000101                                 L24:
   121 00000101 83 7D 10 00                     	CMP	DWORD [16+EBP],0
   122 00000105 0F 88 0000039C                  	JS	L91
   123 0000010B                                 L25:
   124 0000010B 8B 4D 08                        	MOV	ECX,DWORD [8+EBP]
   125 0000010E 8B 41 08                        	MOV	EAX,DWORD [8+ECX]
   126 00000111 39 45 14                        	CMP	DWORD [20+EBP],EAX
   127 00000114 7E 03                           	JLE	L26
   128 00000116 89 45 14                        	MOV	DWORD [20+EBP],EAX
   129 00000119                                 L26:
   130 00000119 8B 5D 08                        	MOV	EBX,DWORD [8+EBP]
   131 0000011C 8B 43 0C                        	MOV	EAX,DWORD [12+EBX]
   132 0000011F 39 45 18                        	CMP	DWORD [24+EBP],EAX
   133 00000122 7E 03                           	JLE	L27
   134 00000124 89 45 18                        	MOV	DWORD [24+EBP],EAX
   135 00000127                                 L27:
   136 00000127 8B 75 1C                        	MOV	ESI,DWORD [28+EBP]
   137 0000012A 8B 45 20                        	MOV	EAX,DWORD [32+EBP]
   138 0000012D 89 75 F0                        	MOV	DWORD [-16+EBP],ESI
   139 00000130 39 C6                           	CMP	ESI,EAX
   140 00000132 0F 8F 0000023B                  	JG	L80
   141 00000138                                 L78:
   142 00000138 8B 4D 08                        	MOV	ECX,DWORD [8+EBP]
   143 0000013B 8B 55 F0                        	MOV	EDX,DWORD [-16+EBP]
   144 0000013E 8B 75 14                        	MOV	ESI,DWORD [20+EBP]
   145 00000141 8B 7C 91 14                     	MOV	EDI,DWORD [20+ECX+EDX*4]
   146 00000145 89 F8                           	MOV	EAX,EDI
   147 00000147 29 C8                           	SUB	EAX,ECX
   148 00000149 8B 57 0C                        	MOV	EDX,DWORD [12+EDI]
   149 0000014C 2D 00000414                     	SUB	EAX,1044
   150 00000151 29 D6                           	SUB	ESI,EDX
   151 00000153 C1 F8 03                        	SAR	EAX,3
   152 00000156 8B 1F                           	MOV	EBX,DWORD [EDI]
   153 00000158 69 C0 CCCCCCCD                  	IMUL	EAX,EAX,-858993459
   154 0000015E 89 5D C8                        	MOV	DWORD [-56+EBP],EBX
   155 00000161 8B 4D 10                        	MOV	ECX,DWORD [16+EBP]
   156 00000164 88 45 BF                        	MOV	BYTE [-65+EBP],AL
   157 00000167 89 75 E4                        	MOV	DWORD [-28+EBP],ESI
   158 0000016A 8B 47 10                        	MOV	EAX,DWORD [16+EDI]
   159 0000016D 8B 5D 18                        	MOV	EBX,DWORD [24+EBP]
   160 00000170 8B 75 0C                        	MOV	ESI,DWORD [12+EBP]
   161 00000173 29 C3                           	SUB	EBX,EAX
   162 00000175 29 C1                           	SUB	ECX,EAX
   163 00000177 89 5D E0                        	MOV	DWORD [-32+EBP],EBX
   164 0000017A 29 D6                           	SUB	ESI,EDX
   165 0000017C 89 75 E8                        	MOV	DWORD [-24+EBP],ESI
   166 0000017F 0F 88 00000316                  	JS	L92
   167 00000185                                 L32:
   168 00000185 85 C9                           	TEST	ECX,ECX
   169 00000187 0F 88 00000307                  	JS	L93
   170 0000018D                                 L33:
   171 0000018D 8B 47 04                        	MOV	EAX,DWORD [4+EDI]
   172 00000190 39 45 E4                        	CMP	DWORD [-28+EBP],EAX
   173 00000193 7E 03                           	JLE	L34
   174 00000195 89 45 E4                        	MOV	DWORD [-28+EBP],EAX
   175 00000198                                 L34:
   176 00000198 8B 47 08                        	MOV	EAX,DWORD [8+EDI]
   177 0000019B 39 45 E0                        	CMP	DWORD [-32+EBP],EAX
   178 0000019E 7E 03                           	JLE	L35
   179 000001A0 89 45 E0                        	MOV	DWORD [-32+EBP],EAX
   180 000001A3                                 L35:
   181 000001A3 83 E2 03                        	AND	EDX,3
   182 000001A6 0F 85 00000286                  	JNE	L36
   183 000001AC 8B 55 E8                        	MOV	EDX,DWORD [-24+EBP]
   184 000001AF BB 00000004                     	MOV	EBX,4
   185 000001B4 83 C2 03                        	ADD	EDX,3
   186 000001B7 89 D0                           	MOV	EAX,EDX
   187 000001B9 99                              	CDQ
   188 000001BA F7 FB                           	IDIV	EBX
   189 000001BC 89 45 A4                        	MOV	DWORD [-92+EBP],EAX
   190 000001BF 8B 45 E4                        	MOV	EAX,DWORD [-28+EBP]
   191 000001C2 99                              	CDQ
   192 000001C3 F7 FB                           	IDIV	EBX
   193 000001C5 8B 55 A4                        	MOV	EDX,DWORD [-92+EBP]
   194 000001C8 29 D0                           	SUB	EAX,EDX
   195 000001CA 89 45 D8                        	MOV	DWORD [-40+EBP],EAX
   196 000001CD 0F B6 45 BF                     	MOVZX	EAX,BYTE [-65+EBP]
   197 000001D1 89 C3                           	MOV	EBX,EAX
   198 000001D3 C1 E3 08                        	SAL	EBX,8
   199 000001D6 09 C3                           	OR	EBX,EAX
   200 000001D8 C1 E0 10                        	SAL	EAX,16
   201 000001DB 09 C3                           	OR	EBX,EAX
   202 000001DD C1 E0 08                        	SAL	EAX,8
   203 000001E0 09 C3                           	OR	EBX,EAX
   204 000001E2 3B 4D E0                        	CMP	ECX,DWORD [-32+EBP]
   205 000001E5 89 5D DC                        	MOV	DWORD [-36+EBP],EBX
   206 000001E8 89 CB                           	MOV	EBX,ECX
   207 000001EA 0F 8D 00000174                  	JGE	L30
   208 000001F0                                 L65:
   209 000001F0 8B 77 10                        	MOV	ESI,DWORD [16+EDI]
   210 000001F3 8B 55 E8                        	MOV	EDX,DWORD [-24+EBP]
   211 000001F6 01 DE                           	ADD	ESI,EBX
   212 000001F8 3B 55 E4                        	CMP	EDX,DWORD [-28+EBP]
   213 000001FB 89 75 EC                        	MOV	DWORD [-20+EBP],ESI
   214 000001FE 7D 3D                           	JGE	L42
   215 00000200 F7 C2 00000003                  	TEST	EDX,3
   216 00000206 74 35                           	JE	L42
   217 00000208                                 L47:
   218 00000208 8B 47 0C                        	MOV	EAX,DWORD [12+EDI]
   219 0000020B 8B 4D 08                        	MOV	ECX,DWORD [8+EBP]
   220 0000020E 01 D0                           	ADD	EAX,EDX
   221 00000210 89 45 A8                        	MOV	DWORD [-88+EBP],EAX
   222 00000213 8B 45 EC                        	MOV	EAX,DWORD [-20+EBP]
   223 00000216 0F AF 41 08                     	IMUL	EAX,DWORD [8+ECX]
   224 0000021A 8B 75 A8                        	MOV	ESI,DWORD [-88+EBP]
   225 0000021D 8D 0C 06                        	LEA	ECX,DWORD [ESI+EAX*1]
   226 00000220 8B 75 C0                        	MOV	ESI,DWORD [-64+EBP]
   227 00000223 8A 45 BF                        	MOV	AL,BYTE [-65+EBP]
   228 00000226 38 04 31                        	CMP	BYTE [ECX+ESI*1],AL
   229 00000229 0F 84 000001EA                  	JE	L94
   230 0000022F                                 L43:
   231 0000022F 42                              	INC	EDX
   232 00000230 3B 55 E4                        	CMP	EDX,DWORD [-28+EBP]
   233 00000233 7D 08                           	JGE	L42
   234 00000235 F7 C2 00000003                  	TEST	EDX,3
   235 0000023B 75 CB                           	JNE	L47
   236 0000023D                                 L42:
   237 0000023D 8B 47 0C                        	MOV	EAX,DWORD [12+EDI]
   238 00000240 8B 4D 08                        	MOV	ECX,DWORD [8+EBP]
   239 00000243 01 D0                           	ADD	EAX,EDX
   240 00000245 8B 75 C0                        	MOV	ESI,DWORD [-64+EBP]
   241 00000248 89 45 A8                        	MOV	DWORD [-88+EBP],EAX
   242 0000024B 8B 45 EC                        	MOV	EAX,DWORD [-20+EBP]
   243 0000024E 0F AF 41 08                     	IMUL	EAX,DWORD [8+ECX]
   244 00000252 03 45 A8                        	ADD	EAX,DWORD [-88+EBP]
   245 00000255 01 C6                           	ADD	ESI,EAX
   246 00000257 03 45 C4                        	ADD	EAX,DWORD [-60+EBP]
   247 0000025A 89 75 D4                        	MOV	DWORD [-44+EBP],ESI
   248 0000025D 89 45 D0                        	MOV	DWORD [-48+EBP],EAX
   249 00000260 89 D8                           	MOV	EAX,EBX
   250 00000262 0F AF 47 04                     	IMUL	EAX,DWORD [4+EDI]
   251 00000266 01 D0                           	ADD	EAX,EDX
   252 00000268 03 45 C8                        	ADD	EAX,DWORD [-56+EBP]
   253 0000026B C7 45 A4 00000000               	MOV	DWORD [-92+EBP],0
   254 00000272 89 45 CC                        	MOV	DWORD [-52+EBP],EAX
   255 00000275 8B 45 D8                        	MOV	EAX,DWORD [-40+EBP]
   256 00000278 39 45 A4                        	CMP	DWORD [-92+EBP],EAX
   257 0000027B 0F 8D 000000AB                  	JGE	L84
   258 00000281 89 55 AC                        	MOV	DWORD [-84+EBP],EDX
   259 00000284                                 L58:
   260 00000284 8B 4D A4                        	MOV	ECX,DWORD [-92+EBP]
   261 00000287 8B 75 D4                        	MOV	ESI,DWORD [-44+EBP]
   262 0000028A 8B 45 DC                        	MOV	EAX,DWORD [-36+EBP]
   263 0000028D 39 04 8E                        	CMP	DWORD [ESI+ECX*4],EAX
   264 00000290 0F 84 00000172                  	JE	L95
   265 00000296 8B 4D 08                        	MOV	ECX,DWORD [8+EBP]
   266 00000299 8B 75 EC                        	MOV	ESI,DWORD [-20+EBP]
   267 0000029C 8B 45 AC                        	MOV	EAX,DWORD [-84+EBP]
   268 0000029F 0F AF 71 08                     	IMUL	ESI,DWORD [8+ECX]
   269 000002A3 03 47 0C                        	ADD	EAX,DWORD [12+EDI]
   270 000002A6 8B 4D C0                        	MOV	ECX,DWORD [-64+EBP]
   271 000002A9 01 C6                           	ADD	ESI,EAX
   272 000002AB 89 45 A8                        	MOV	DWORD [-88+EBP],EAX
   273 000002AE 89 75 B8                        	MOV	DWORD [-72+EBP],ESI
   274 000002B1 8A 45 BF                        	MOV	AL,BYTE [-65+EBP]
   275 000002B4 38 04 0E                        	CMP	BYTE [ESI+ECX*1],AL
   276 000002B7 0F 84 0000012E                  	JE	L96
   277 000002BD                                 L54:
   278 000002BD 8B 4D 08                        	MOV	ECX,DWORD [8+EBP]
   279 000002C0 8B 45 EC                        	MOV	EAX,DWORD [-20+EBP]
   280 000002C3 8B 75 C0                        	MOV	ESI,DWORD [-64+EBP]
   281 000002C6 0F AF 41 08                     	IMUL	EAX,DWORD [8+ECX]
   282 000002CA 03 45 A8                        	ADD	EAX,DWORD [-88+EBP]
   283 000002CD 8A 4D BF                        	MOV	CL,BYTE [-65+EBP]
   284 000002D0 89 45 B4                        	MOV	DWORD [-76+EBP],EAX
   285 000002D3 38 4C 30 01                     	CMP	BYTE [1+EAX+ESI*1],CL
   286 000002D7 0F 84 000000EF                  	JE	L97
   287 000002DD                                 L55:
   288 000002DD 8B 75 08                        	MOV	ESI,DWORD [8+EBP]
   289 000002E0 8B 45 EC                        	MOV	EAX,DWORD [-20+EBP]
   290 000002E3 8A 4D BF                        	MOV	CL,BYTE [-65+EBP]
   291 000002E6 0F AF 46 08                     	IMUL	EAX,DWORD [8+ESI]
   292 000002EA 03 45 A8                        	ADD	EAX,DWORD [-88+EBP]
   293 000002ED 8B 75 C0                        	MOV	ESI,DWORD [-64+EBP]
   294 000002F0 89 45 B0                        	MOV	DWORD [-80+EBP],EAX
   295 000002F3 38 4C 30 02                     	CMP	BYTE [2+EAX+ESI*1],CL
   296 000002F7 0F 84 000000B0                  	JE	L98
   297 000002FD                                 L56:
   298 000002FD 8B 75 08                        	MOV	ESI,DWORD [8+EBP]
   299 00000300 8B 45 EC                        	MOV	EAX,DWORD [-20+EBP]
   300 00000303 0F AF 46 08                     	IMUL	EAX,DWORD [8+ESI]
   301 00000307 8B 75 A8                        	MOV	ESI,DWORD [-88+EBP]
   302 0000030A 8D 0C 06                        	LEA	ECX,DWORD [ESI+EAX*1]
   303 0000030D 8B 75 C0                        	MOV	ESI,DWORD [-64+EBP]
   304 00000310 8A 45 BF                        	MOV	AL,BYTE [-65+EBP]
   305 00000313 38 44 31 03                     	CMP	BYTE [3+ECX+ESI*1],AL
   306 00000317 74 78                           	JE	L99
   307 00000319                                 L50:
   308 00000319 8B 45 D8                        	MOV	EAX,DWORD [-40+EBP]
   309 0000031C FF 45 A4                        	INC	DWORD [-92+EBP]
   310 0000031F 83 45 AC 04                     	ADD	DWORD [-84+EBP],4
   311 00000323 39 45 A4                        	CMP	DWORD [-92+EBP],EAX
   312 00000326 0F 8C FFFFFF58                  	JL	L58
   313 0000032C                                 L84:
   314 0000032C 8B 4D D8                        	MOV	ECX,DWORD [-40+EBP]
   315 0000032F 8D 14 8A                        	LEA	EDX,DWORD [EDX+ECX*4]
   316 00000332 3B 55 E4                        	CMP	EDX,DWORD [-28+EBP]
   317 00000335 7D 23                           	JGE	L86
   318 00000337                                 L64:
   319 00000337 8B 4D 08                        	MOV	ECX,DWORD [8+EBP]
   320 0000033A 8B 45 EC                        	MOV	EAX,DWORD [-20+EBP]
   321 0000033D 8B 77 0C                        	MOV	ESI,DWORD [12+EDI]
   322 00000340 0F AF 41 08                     	IMUL	EAX,DWORD [8+ECX]
   323 00000344 01 D6                           	ADD	ESI,EDX
   324 00000346 8D 0C 06                        	LEA	ECX,DWORD [ESI+EAX*1]
   325 00000349 8B 75 C0                        	MOV	ESI,DWORD [-64+EBP]
   326 0000034C 8A 45 BF                        	MOV	AL,BYTE [-65+EBP]
   327 0000034F 38 04 31                        	CMP	BYTE [ECX+ESI*1],AL
   328 00000352 74 27                           	JE	L100
   329 00000354                                 L61:
   330 00000354 42                              	INC	EDX
   331 00000355 3B 55 E4                        	CMP	EDX,DWORD [-28+EBP]
   332 00000358 7C DD                           	JL	L64
   333 0000035A                                 L86:
   334 0000035A 43                              	INC	EBX
   335 0000035B 3B 5D E0                        	CMP	EBX,DWORD [-32+EBP]
   336 0000035E 0F 8C FFFFFE8C                  	JL	L65
   337 00000364                                 L30:
   338 00000364 8B 45 20                        	MOV	EAX,DWORD [32+EBP]
   339 00000367 FF 45 F0                        	INC	DWORD [-16+EBP]
   340 0000036A 39 45 F0                        	CMP	DWORD [-16+EBP],EAX
   341 0000036D 0F 8E FFFFFDC5                  	JLE	L78
   342 00000373                                 L80:
   343 00000373 83 C4 54                        	ADD	ESP,84
   344 00000376 5B                              	POP	EBX
   345 00000377 5E                              	POP	ESI
   346 00000378 5F                              	POP	EDI
   347 00000379 5D                              	POP	EBP
   348 0000037A C3                              	RET
   349 0000037B                                 L100:
   350 0000037B 89 D8                           	MOV	EAX,EBX
   351 0000037D 8B 75 C8                        	MOV	ESI,DWORD [-56+EBP]
   352 00000380 0F AF 47 04                     	IMUL	EAX,DWORD [4+EDI]
   353 00000384 01 D0                           	ADD	EAX,EDX
   354 00000386 8A 04 30                        	MOV	AL,BYTE [EAX+ESI*1]
   355 00000389 8B 75 C4                        	MOV	ESI,DWORD [-60+EBP]
   356 0000038C 88 04 31                        	MOV	BYTE [ECX+ESI*1],AL
   357 0000038F EB C3                           	JMP	L61
   358 00000391                                 L99:
   359 00000391 89 D8                           	MOV	EAX,EBX
   360 00000393 8B 75 C8                        	MOV	ESI,DWORD [-56+EBP]
   361 00000396 0F AF 47 04                     	IMUL	EAX,DWORD [4+EDI]
   362 0000039A 03 45 AC                        	ADD	EAX,DWORD [-84+EBP]
   363 0000039D 8A 44 30 03                     	MOV	AL,BYTE [3+EAX+ESI*1]
   364 000003A1 8B 75 C4                        	MOV	ESI,DWORD [-60+EBP]
   365 000003A4 88 44 31 03                     	MOV	BYTE [3+ECX+ESI*1],AL
   366 000003A8 E9 FFFFFF6C                     	JMP	L50
   367 000003AD                                 L98:
   368 000003AD 89 D8                           	MOV	EAX,EBX
   369 000003AF 8B 4D C8                        	MOV	ECX,DWORD [-56+EBP]
   370 000003B2 0F AF 47 04                     	IMUL	EAX,DWORD [4+EDI]
   371 000003B6 03 45 AC                        	ADD	EAX,DWORD [-84+EBP]
   372 000003B9 8B 75 C4                        	MOV	ESI,DWORD [-60+EBP]
   373 000003BC 8A 44 08 02                     	MOV	AL,BYTE [2+EAX+ECX*1]
   374 000003C0 8B 4D B0                        	MOV	ECX,DWORD [-80+EBP]
   375 000003C3 88 44 31 02                     	MOV	BYTE [2+ECX+ESI*1],AL
   376 000003C7 E9 FFFFFF31                     	JMP	L56
   377 000003CC                                 L97:
   378 000003CC 89 D8                           	MOV	EAX,EBX
   379 000003CE 8B 4D C8                        	MOV	ECX,DWORD [-56+EBP]
   380 000003D1 0F AF 47 04                     	IMUL	EAX,DWORD [4+EDI]
   381 000003D5 03 45 AC                        	ADD	EAX,DWORD [-84+EBP]
   382 000003D8 8B 75 C4                        	MOV	ESI,DWORD [-60+EBP]
   383 000003DB 8A 44 08 01                     	MOV	AL,BYTE [1+EAX+ECX*1]
   384 000003DF 8B 4D B4                        	MOV	ECX,DWORD [-76+EBP]
   385 000003E2 88 44 31 01                     	MOV	BYTE [1+ECX+ESI*1],AL
   386 000003E6 E9 FFFFFEF2                     	JMP	L55
   387 000003EB                                 L96:
   388 000003EB 89 D8                           	MOV	EAX,EBX
   389 000003ED 8B 75 C8                        	MOV	ESI,DWORD [-56+EBP]
   390 000003F0 0F AF 47 04                     	IMUL	EAX,DWORD [4+EDI]
   391 000003F4 03 45 AC                        	ADD	EAX,DWORD [-84+EBP]
   392 000003F7 8B 4D C4                        	MOV	ECX,DWORD [-60+EBP]
   393 000003FA 8A 04 30                        	MOV	AL,BYTE [EAX+ESI*1]
   394 000003FD 8B 75 B8                        	MOV	ESI,DWORD [-72+EBP]
   395 00000400 88 04 0E                        	MOV	BYTE [ESI+ECX*1],AL
   396 00000403 E9 FFFFFEB5                     	JMP	L54
   397 00000408                                 L95:
   398 00000408 8B 75 CC                        	MOV	ESI,DWORD [-52+EBP]
   399 0000040B 8B 04 8E                        	MOV	EAX,DWORD [ESI+ECX*4]
   400 0000040E 8B 75 D0                        	MOV	ESI,DWORD [-48+EBP]
   401 00000411 89 04 8E                        	MOV	DWORD [ESI+ECX*4],EAX
   402 00000414 E9 FFFFFF00                     	JMP	L50
   403 00000419                                 L94:
   404 00000419 89 D8                           	MOV	EAX,EBX
   405 0000041B 8B 75 C8                        	MOV	ESI,DWORD [-56+EBP]
   406 0000041E 0F AF 47 04                     	IMUL	EAX,DWORD [4+EDI]
   407 00000422 01 D0                           	ADD	EAX,EDX
   408 00000424 8A 04 30                        	MOV	AL,BYTE [EAX+ESI*1]
   409 00000427 8B 75 C4                        	MOV	ESI,DWORD [-60+EBP]
   410 0000042A 88 04 31                        	MOV	BYTE [ECX+ESI*1],AL
   411 0000042D E9 FFFFFDFD                     	JMP	L43
   412 00000432                                 L36:
   413 00000432 89 CB                           	MOV	EBX,ECX
   414 00000434 3B 4D E0                        	CMP	ECX,DWORD [-32+EBP]
   415 00000437 0F 8D FFFFFF27                  	JGE	L30
   416 0000043D                                 L77:
   417 0000043D 8B 47 10                        	MOV	EAX,DWORD [16+EDI]
   418 00000440 8B 55 E8                        	MOV	EDX,DWORD [-24+EBP]
   419 00000443 01 D8                           	ADD	EAX,EBX
   420 00000445 3B 55 E4                        	CMP	EDX,DWORD [-28+EBP]
   421 00000448 89 45 EC                        	MOV	DWORD [-20+EBP],EAX
   422 0000044B 7D 26                           	JGE	L89
   423 0000044D                                 L76:
   424 0000044D 8B 75 08                        	MOV	ESI,DWORD [8+EBP]
   425 00000450 8B 45 EC                        	MOV	EAX,DWORD [-20+EBP]
   426 00000453 8B 4F 0C                        	MOV	ECX,DWORD [12+EDI]
   427 00000456 0F AF 46 08                     	IMUL	EAX,DWORD [8+ESI]
   428 0000045A 01 D1                           	ADD	ECX,EDX
   429 0000045C 8B 75 C0                        	MOV	ESI,DWORD [-64+EBP]
   430 0000045F 89 4D A8                        	MOV	DWORD [-88+EBP],ECX
   431 00000462 8D 0C 01                        	LEA	ECX,DWORD [ECX+EAX*1]
   432 00000465 8A 45 BF                        	MOV	AL,BYTE [-65+EBP]
   433 00000468 38 04 31                        	CMP	BYTE [ECX+ESI*1],AL
   434 0000046B 74 11                           	JE	L101
   435 0000046D                                 L73:
   436 0000046D 42                              	INC	EDX
   437 0000046E 3B 55 E4                        	CMP	EDX,DWORD [-28+EBP]
   438 00000471 7C DA                           	JL	L76
   439 00000473                                 L89:
   440 00000473 43                              	INC	EBX
   441 00000474 3B 5D E0                        	CMP	EBX,DWORD [-32+EBP]
   442 00000477 7C C4                           	JL	L77
   443 00000479 E9 FFFFFEE6                     	JMP	L30
   444 0000047E                                 L101:
   445 0000047E 89 D8                           	MOV	EAX,EBX
   446 00000480 8B 75 C8                        	MOV	ESI,DWORD [-56+EBP]
   447 00000483 0F AF 47 04                     	IMUL	EAX,DWORD [4+EDI]
   448 00000487 01 D0                           	ADD	EAX,EDX
   449 00000489 8A 04 30                        	MOV	AL,BYTE [EAX+ESI*1]
   450 0000048C 8B 75 C4                        	MOV	ESI,DWORD [-60+EBP]
   451 0000048F 88 04 31                        	MOV	BYTE [ECX+ESI*1],AL
   452 00000492 EB D9                           	JMP	L73
   453 00000494                                 L93:
   454 00000494 31 C9                           	XOR	ECX,ECX
   455 00000496 E9 FFFFFCF2                     	JMP	L33
   456 0000049B                                 L92:
   457 0000049B C7 45 E8 00000000               	MOV	DWORD [-24+EBP],0
   458 000004A2 E9 FFFFFCDE                     	JMP	L32
   459 000004A7                                 L91:
   460 000004A7 C7 45 10 00000000               	MOV	DWORD [16+EBP],0
   461 000004AE E9 FFFFFC58                     	JMP	L25
   462 000004B3                                 L90:
   463 000004B3 C7 45 0C 00000000               	MOV	DWORD [12+EBP],0
   464 000004BA E9 FFFFFC42                     	JMP	L24
   465 000004BF                                 	GLOBAL	_sheet_updown
   466 000004BF                                 _sheet_updown:
   467 000004BF 55                              	PUSH	EBP
   468 000004C0 89 E5                           	MOV	EBP,ESP
   469 000004C2 57                              	PUSH	EDI
   470 000004C3 56                              	PUSH	ESI
   471 000004C4 53                              	PUSH	EBX
   472 000004C5 51                              	PUSH	ECX
   473 000004C6 8B 7D 08                        	MOV	EDI,DWORD [8+EBP]
   474 000004C9 8B 5D 0C                        	MOV	EBX,DWORD [12+EBP]
   475 000004CC 8B 77 20                        	MOV	ESI,DWORD [32+EDI]
   476 000004CF 8B 47 18                        	MOV	EAX,DWORD [24+EDI]
   477 000004D2 89 45 F0                        	MOV	DWORD [-16+EBP],EAX
   478 000004D5 8B 46 10                        	MOV	EAX,DWORD [16+ESI]
   479 000004D8 40                              	INC	EAX
   480 000004D9 39 C3                           	CMP	EBX,EAX
   481 000004DB 7E 02                           	JLE	L103
   482 000004DD 89 C3                           	MOV	EBX,EAX
   483 000004DF                                 L103:
   484 000004DF 83 FB FF                        	CMP	EBX,-1
   485 000004E2 7D 03                           	JGE	L104
   486 000004E4 83 CB FF                        	OR	EBX,-1
   487 000004E7                                 L104:
   488 000004E7 89 5F 18                        	MOV	DWORD [24+EDI],EBX
   489 000004EA 39 5D F0                        	CMP	DWORD [-16+EBP],EBX
   490 000004ED 0F 8E 000000A8                  	JLE	L105
   491 000004F3 85 DB                           	TEST	EBX,EBX
   492 000004F5 78 5C                           	JS	L106
   493 000004F7 8B 4D F0                        	MOV	ECX,DWORD [-16+EBP]
   494 000004FA                                 L111:
   495 000004FA 8B 44 8E 10                     	MOV	EAX,DWORD [16+ESI+ECX*4]
   496 000004FE 89 44 8E 14                     	MOV	DWORD [20+ESI+ECX*4],EAX
   497 00000502 89 48 18                        	MOV	DWORD [24+EAX],ECX
   498 00000505 49                              	DEC	ECX
   499 00000506 39 D9                           	CMP	ECX,EBX
   500 00000508 7F F0                           	JG	L111
   501 0000050A 89 7C 9E 14                     	MOV	DWORD [20+ESI+EBX*4],EDI
   502 0000050E 43                              	INC	EBX
   503 0000050F 53                              	PUSH	EBX
   504 00000510 8B 4F 10                        	MOV	ECX,DWORD [16+EDI]
   505 00000513 89 C8                           	MOV	EAX,ECX
   506 00000515 03 47 08                        	ADD	EAX,DWORD [8+EDI]
   507 00000518 50                              	PUSH	EAX
   508 00000519 8B 57 0C                        	MOV	EDX,DWORD [12+EDI]
   509 0000051C 89 D0                           	MOV	EAX,EDX
   510 0000051E 03 47 04                        	ADD	EAX,DWORD [4+EDI]
   511 00000521 50                              	PUSH	EAX
   512 00000522 51                              	PUSH	ECX
   513 00000523 52                              	PUSH	EDX
   514 00000524 56                              	PUSH	ESI
   515 00000525 E8 000001C1                     	CALL	_sheet_refreshmap
   516 0000052A FF 75 F0                        	PUSH	DWORD [-16+EBP]
   517 0000052D                                 L141:
   518 0000052D 53                              	PUSH	EBX
   519 0000052E                                 L140:
   520 0000052E 8B 4F 10                        	MOV	ECX,DWORD [16+EDI]
   521 00000531 89 C8                           	MOV	EAX,ECX
   522 00000533 03 47 08                        	ADD	EAX,DWORD [8+EDI]
   523 00000536 50                              	PUSH	EAX
   524 00000537 8B 57 0C                        	MOV	EDX,DWORD [12+EDI]
   525 0000053A 89 D0                           	MOV	EAX,EDX
   526 0000053C 03 47 04                        	ADD	EAX,DWORD [4+EDI]
   527 0000053F 50                              	PUSH	EAX
   528 00000540 51                              	PUSH	ECX
   529 00000541 52                              	PUSH	EDX
   530 00000542 56                              	PUSH	ESI
   531 00000543 E8 FFFFFB95                     	CALL	_sheet_refreshsub
   532 00000548 83 C4 34                        	ADD	ESP,52
   533 0000054B                                 L102:
   534 0000054B 8D 65 F4                        	LEA	ESP,DWORD [-12+EBP]
   535 0000054E 5B                              	POP	EBX
   536 0000054F 5E                              	POP	ESI
   537 00000550 5F                              	POP	EDI
   538 00000551 5D                              	POP	EBP
   539 00000552 C3                              	RET
   540 00000553                                 L106:
   541 00000553 8B 46 10                        	MOV	EAX,DWORD [16+ESI]
   542 00000556 3B 45 F0                        	CMP	EAX,DWORD [-16+EBP]
   543 00000559 7E 18                           	JLE	L113
   544 0000055B 8B 4D F0                        	MOV	ECX,DWORD [-16+EBP]
   545 0000055E 39 C1                           	CMP	ECX,EAX
   546 00000560 7D 11                           	JGE	L113
   547 00000562                                 L118:
   548 00000562 8B 44 8E 18                     	MOV	EAX,DWORD [24+ESI+ECX*4]
   549 00000566 89 44 8E 14                     	MOV	DWORD [20+ESI+ECX*4],EAX
   550 0000056A 89 48 18                        	MOV	DWORD [24+EAX],ECX
   551 0000056D 41                              	INC	ECX
   552 0000056E 3B 4E 10                        	CMP	ECX,DWORD [16+ESI]
   553 00000571 7C EF                           	JL	L118
   554 00000573                                 L113:
   555 00000573 FF 4E 10                        	DEC	DWORD [16+ESI]
   556 00000576 6A 00                           	PUSH	0
   557 00000578 8B 4F 10                        	MOV	ECX,DWORD [16+EDI]
   558 0000057B 89 C8                           	MOV	EAX,ECX
   559 0000057D 03 47 08                        	ADD	EAX,DWORD [8+EDI]
   560 00000580 50                              	PUSH	EAX
   561 00000581 8B 57 0C                        	MOV	EDX,DWORD [12+EDI]
   562 00000584 89 D0                           	MOV	EAX,EDX
   563 00000586 03 47 04                        	ADD	EAX,DWORD [4+EDI]
   564 00000589 50                              	PUSH	EAX
   565 0000058A 51                              	PUSH	ECX
   566 0000058B 52                              	PUSH	EDX
   567 0000058C 56                              	PUSH	ESI
   568 0000058D E8 00000159                     	CALL	_sheet_refreshmap
   569 00000592 8B 45 F0                        	MOV	EAX,DWORD [-16+EBP]
   570 00000595 48                              	DEC	EAX
   571 00000596 50                              	PUSH	EAX
   572 00000597 6A 00                           	PUSH	0
   573 00000599 EB 93                           	JMP	L140
   574 0000059B                                 L105:
   575 0000059B 39 5D F0                        	CMP	DWORD [-16+EBP],EBX
   576 0000059E 7D AB                           	JGE	L102
   577 000005A0 83 7D F0 00                     	CMP	DWORD [-16+EBP],0
   578 000005A4 78 3C                           	JS	L121
   579 000005A6 8B 4D F0                        	MOV	ECX,DWORD [-16+EBP]
   580 000005A9 39 D9                           	CMP	ECX,EBX
   581 000005AB 7D 10                           	JGE	L137
   582 000005AD                                 L126:
   583 000005AD 8B 44 8E 18                     	MOV	EAX,DWORD [24+ESI+ECX*4]
   584 000005B1 89 44 8E 14                     	MOV	DWORD [20+ESI+ECX*4],EAX
   585 000005B5 89 48 18                        	MOV	DWORD [24+EAX],ECX
   586 000005B8 41                              	INC	ECX
   587 000005B9 39 D9                           	CMP	ECX,EBX
   588 000005BB 7C F0                           	JL	L126
   589 000005BD                                 L137:
   590 000005BD 89 7C 9E 14                     	MOV	DWORD [20+ESI+EBX*4],EDI
   591 000005C1                                 L127:
   592 000005C1 53                              	PUSH	EBX
   593 000005C2 8B 4F 10                        	MOV	ECX,DWORD [16+EDI]
   594 000005C5 89 C8                           	MOV	EAX,ECX
   595 000005C7 03 47 08                        	ADD	EAX,DWORD [8+EDI]
   596 000005CA 50                              	PUSH	EAX
   597 000005CB 8B 57 0C                        	MOV	EDX,DWORD [12+EDI]
   598 000005CE 89 D0                           	MOV	EAX,EDX
   599 000005D0 03 47 04                        	ADD	EAX,DWORD [4+EDI]
   600 000005D3 50                              	PUSH	EAX
   601 000005D4 51                              	PUSH	ECX
   602 000005D5 52                              	PUSH	EDX
   603 000005D6 56                              	PUSH	ESI
   604 000005D7 E8 0000010F                     	CALL	_sheet_refreshmap
   605 000005DC 53                              	PUSH	EBX
   606 000005DD E9 FFFFFF4B                     	JMP	L141
   607 000005E2                                 L121:
   608 000005E2 8B 4E 10                        	MOV	ECX,DWORD [16+ESI]
   609 000005E5 39 D9                           	CMP	ECX,EBX
   610 000005E7 7C 13                           	JL	L139
   611 000005E9                                 L132:
   612 000005E9 8B 54 8E 14                     	MOV	EDX,DWORD [20+ESI+ECX*4]
   613 000005ED 8D 41 01                        	LEA	EAX,DWORD [1+ECX]
   614 000005F0 89 54 8E 18                     	MOV	DWORD [24+ESI+ECX*4],EDX
   615 000005F4 49                              	DEC	ECX
   616 000005F5 89 42 18                        	MOV	DWORD [24+EDX],EAX
   617 000005F8 39 D9                           	CMP	ECX,EBX
   618 000005FA 7D ED                           	JGE	L132
   619 000005FC                                 L139:
   620 000005FC 89 7C 9E 14                     	MOV	DWORD [20+ESI+EBX*4],EDI
   621 00000600 FF 46 10                        	INC	DWORD [16+ESI]
   622 00000603 EB BC                           	JMP	L127
   623 00000605                                 	GLOBAL	_sheet_refresh
   624 00000605                                 _sheet_refresh:
   625 00000605 55                              	PUSH	EBP
   626 00000606 89 E5                           	MOV	EBP,ESP
   627 00000608 53                              	PUSH	EBX
   628 00000609 8B 5D 08                        	MOV	EBX,DWORD [8+EBP]
   629 0000060C 8B 43 18                        	MOV	EAX,DWORD [24+EBX]
   630 0000060F 85 C0                           	TEST	EAX,EAX
   631 00000611 78 27                           	JS	L142
   632 00000613 50                              	PUSH	EAX
   633 00000614 50                              	PUSH	EAX
   634 00000615 8B 4B 10                        	MOV	ECX,DWORD [16+EBX]
   635 00000618 89 C8                           	MOV	EAX,ECX
   636 0000061A 03 4D 10                        	ADD	ECX,DWORD [16+EBP]
   637 0000061D 03 45 18                        	ADD	EAX,DWORD [24+EBP]
   638 00000620 50                              	PUSH	EAX
   639 00000621 8B 53 0C                        	MOV	EDX,DWORD [12+EBX]
   640 00000624 89 D0                           	MOV	EAX,EDX
   641 00000626 03 55 0C                        	ADD	EDX,DWORD [12+EBP]
   642 00000629 03 45 14                        	ADD	EAX,DWORD [20+EBP]
   643 0000062C 50                              	PUSH	EAX
   644 0000062D 51                              	PUSH	ECX
   645 0000062E 52                              	PUSH	EDX
   646 0000062F FF 73 20                        	PUSH	DWORD [32+EBX]
   647 00000632 E8 FFFFFAA6                     	CALL	_sheet_refreshsub
   648 00000637 83 C4 1C                        	ADD	ESP,28
   649 0000063A                                 L142:
   650 0000063A 8B 5D FC                        	MOV	EBX,DWORD [-4+EBP]
   651 0000063D C9                              	LEAVE
   652 0000063E C3                              	RET
   653 0000063F                                 	GLOBAL	_sheet_slide
   654 0000063F                                 _sheet_slide:
   655 0000063F 55                              	PUSH	EBP
   656 00000640 89 E5                           	MOV	EBP,ESP
   657 00000642 57                              	PUSH	EDI
   658 00000643 56                              	PUSH	ESI
   659 00000644 53                              	PUSH	EBX
   660 00000645 53                              	PUSH	EBX
   661 00000646 8B 5D 08                        	MOV	EBX,DWORD [8+EBP]
   662 00000649 8B 43 20                        	MOV	EAX,DWORD [32+EBX]
   663 0000064C 8B 7B 0C                        	MOV	EDI,DWORD [12+EBX]
   664 0000064F 89 45 F0                        	MOV	DWORD [-16+EBP],EAX
   665 00000652 8B 73 10                        	MOV	ESI,DWORD [16+EBX]
   666 00000655 8B 45 0C                        	MOV	EAX,DWORD [12+EBP]
   667 00000658 89 43 0C                        	MOV	DWORD [12+EBX],EAX
   668 0000065B 8B 45 10                        	MOV	EAX,DWORD [16+EBP]
   669 0000065E 89 43 10                        	MOV	DWORD [16+EBX],EAX
   670 00000661 83 7B 18 00                     	CMP	DWORD [24+EBX],0
   671 00000665 78 7C                           	JS	L144
   672 00000667 6A 00                           	PUSH	0
   673 00000669 89 F0                           	MOV	EAX,ESI
   674 0000066B 03 43 08                        	ADD	EAX,DWORD [8+EBX]
   675 0000066E 50                              	PUSH	EAX
   676 0000066F 89 F8                           	MOV	EAX,EDI
   677 00000671 03 43 04                        	ADD	EAX,DWORD [4+EBX]
   678 00000674 50                              	PUSH	EAX
   679 00000675 56                              	PUSH	ESI
   680 00000676 57                              	PUSH	EDI
   681 00000677 FF 75 F0                        	PUSH	DWORD [-16+EBP]
   682 0000067A E8 0000006C                     	CALL	_sheet_refreshmap
   683 0000067F 8B 45 10                        	MOV	EAX,DWORD [16+EBP]
   684 00000682 FF 73 18                        	PUSH	DWORD [24+EBX]
   685 00000685 03 43 08                        	ADD	EAX,DWORD [8+EBX]
   686 00000688 50                              	PUSH	EAX
   687 00000689 8B 45 0C                        	MOV	EAX,DWORD [12+EBP]
   688 0000068C 03 43 04                        	ADD	EAX,DWORD [4+EBX]
   689 0000068F 50                              	PUSH	EAX
   690 00000690 FF 75 10                        	PUSH	DWORD [16+EBP]
   691 00000693 FF 75 0C                        	PUSH	DWORD [12+EBP]
   692 00000696 FF 75 F0                        	PUSH	DWORD [-16+EBP]
   693 00000699 E8 0000004D                     	CALL	_sheet_refreshmap
   694 0000069E 8B 43 18                        	MOV	EAX,DWORD [24+EBX]
   695 000006A1 83 C4 30                        	ADD	ESP,48
   696 000006A4 48                              	DEC	EAX
   697 000006A5 50                              	PUSH	EAX
   698 000006A6 89 F0                           	MOV	EAX,ESI
   699 000006A8 6A 00                           	PUSH	0
   700 000006AA 03 43 08                        	ADD	EAX,DWORD [8+EBX]
   701 000006AD 50                              	PUSH	EAX
   702 000006AE 89 F8                           	MOV	EAX,EDI
   703 000006B0 03 43 04                        	ADD	EAX,DWORD [4+EBX]
   704 000006B3 50                              	PUSH	EAX
   705 000006B4 56                              	PUSH	ESI
   706 000006B5 57                              	PUSH	EDI
   707 000006B6 FF 75 F0                        	PUSH	DWORD [-16+EBP]
   708 000006B9 E8 FFFFFA1F                     	CALL	_sheet_refreshsub
   709 000006BE 8B 45 10                        	MOV	EAX,DWORD [16+EBP]
   710 000006C1 FF 73 18                        	PUSH	DWORD [24+EBX]
   711 000006C4 FF 73 18                        	PUSH	DWORD [24+EBX]
   712 000006C7 03 43 08                        	ADD	EAX,DWORD [8+EBX]
   713 000006CA 50                              	PUSH	EAX
   714 000006CB 8B 45 0C                        	MOV	EAX,DWORD [12+EBP]
   715 000006CE 03 43 04                        	ADD	EAX,DWORD [4+EBX]
   716 000006D1 50                              	PUSH	EAX
   717 000006D2 FF 75 10                        	PUSH	DWORD [16+EBP]
   718 000006D5 FF 75 0C                        	PUSH	DWORD [12+EBP]
   719 000006D8 FF 75 F0                        	PUSH	DWORD [-16+EBP]
   720 000006DB E8 FFFFF9FD                     	CALL	_sheet_refreshsub
   721 000006E0 83 C4 38                        	ADD	ESP,56
   722 000006E3                                 L144:
   723 000006E3 8D 65 F4                        	LEA	ESP,DWORD [-12+EBP]
   724 000006E6 5B                              	POP	EBX
   725 000006E7 5E                              	POP	ESI
   726 000006E8 5F                              	POP	EDI
   727 000006E9 5D                              	POP	EBP
   728 000006EA C3                              	RET
   729 000006EB                                 	GLOBAL	_sheet_refreshmap
   730 000006EB                                 _sheet_refreshmap:
   731 000006EB 55                              	PUSH	EBP
   732 000006EC 89 E5                           	MOV	EBP,ESP
   733 000006EE 57                              	PUSH	EDI
   734 000006EF 56                              	PUSH	ESI
   735 000006F0 53                              	PUSH	EBX
   736 000006F1 83 EC 30                        	SUB	ESP,48
   737 000006F4 8B 45 08                        	MOV	EAX,DWORD [8+EBP]
   738 000006F7 83 7D 0C 00                     	CMP	DWORD [12+EBP],0
   739 000006FB 8B 40 04                        	MOV	EAX,DWORD [4+EAX]
   740 000006FE 89 45 D4                        	MOV	DWORD [-44+EBP],EAX
   741 00000701 0F 88 00000203                  	JS	L206
   742 00000707                                 L147:
   743 00000707 83 7D 10 00                     	CMP	DWORD [16+EBP],0
   744 0000070B 0F 88 000001ED                  	JS	L207
   745 00000711                                 L148:
   746 00000711 8B 55 08                        	MOV	EDX,DWORD [8+EBP]
   747 00000714 8B 42 08                        	MOV	EAX,DWORD [8+EDX]
   748 00000717 39 45 14                        	CMP	DWORD [20+EBP],EAX
   749 0000071A 7E 03                           	JLE	L149
   750 0000071C 89 45 14                        	MOV	DWORD [20+EBP],EAX
   751 0000071F                                 L149:
   752 0000071F 8B 4D 08                        	MOV	ECX,DWORD [8+EBP]
   753 00000722 8B 41 0C                        	MOV	EAX,DWORD [12+ECX]
   754 00000725 39 45 18                        	CMP	DWORD [24+EBP],EAX
   755 00000728 7E 03                           	JLE	L150
   756 0000072A 89 45 18                        	MOV	DWORD [24+EBP],EAX
   757 0000072D                                 L150:
   758 0000072D 8B 75 08                        	MOV	ESI,DWORD [8+EBP]
   759 00000730 8B 5D 1C                        	MOV	EBX,DWORD [28+EBP]
   760 00000733 89 5D F0                        	MOV	DWORD [-16+EBP],EBX
   761 00000736 3B 5E 10                        	CMP	EBX,DWORD [16+ESI]
   762 00000739 0F 8F 000000DA                  	JG	L196
   763 0000073F                                 L194:
   764 0000073F 8B 55 08                        	MOV	EDX,DWORD [8+EBP]
   765 00000742 8B 45 F0                        	MOV	EAX,DWORD [-16+EBP]
   766 00000745 8B 75 18                        	MOV	ESI,DWORD [24+EBP]
   767 00000748 8B 5D 14                        	MOV	EBX,DWORD [20+EBP]
   768 0000074B 8B 7C 82 14                     	MOV	EDI,DWORD [20+EDX+EAX*4]
   769 0000074F 89 F8                           	MOV	EAX,EDI
   770 00000751 29 D0                           	SUB	EAX,EDX
   771 00000753 8B 0F                           	MOV	ECX,DWORD [EDI]
   772 00000755 2D 00000414                     	SUB	EAX,1044
   773 0000075A 89 4D DC                        	MOV	DWORD [-36+EBP],ECX
   774 0000075D C1 F8 03                        	SAR	EAX,3
   775 00000760 8B 4D 10                        	MOV	ECX,DWORD [16+EBP]
   776 00000763 69 C0 CCCCCCCD                  	IMUL	EAX,EAX,-858993459
   777 00000769 88 45 DB                        	MOV	BYTE [-37+EBP],AL
   778 0000076C 8B 57 0C                        	MOV	EDX,DWORD [12+EDI]
   779 0000076F 8B 47 10                        	MOV	EAX,DWORD [16+EDI]
   780 00000772 29 D3                           	SUB	EBX,EDX
   781 00000774 29 C6                           	SUB	ESI,EAX
   782 00000776 29 C1                           	SUB	ECX,EAX
   783 00000778 8B 45 0C                        	MOV	EAX,DWORD [12+EBP]
   784 0000077B 89 5D E8                        	MOV	DWORD [-24+EBP],EBX
   785 0000077E 29 D0                           	SUB	EAX,EDX
   786 00000780 89 75 E4                        	MOV	DWORD [-28+EBP],ESI
   787 00000783 89 45 EC                        	MOV	DWORD [-20+EBP],EAX
   788 00000786 0F 88 00000166                  	JS	L208
   789 0000078C                                 L155:
   790 0000078C 85 C9                           	TEST	ECX,ECX
   791 0000078E 0F 88 00000157                  	JS	L209
   792 00000794                                 L156:
   793 00000794 8B 47 04                        	MOV	EAX,DWORD [4+EDI]
   794 00000797 39 45 E8                        	CMP	DWORD [-24+EBP],EAX
   795 0000079A 7E 03                           	JLE	L157
   796 0000079C 89 45 E8                        	MOV	DWORD [-24+EBP],EAX
   797 0000079F                                 L157:
   798 0000079F 8B 47 08                        	MOV	EAX,DWORD [8+EDI]
   799 000007A2 39 45 E4                        	CMP	DWORD [-28+EBP],EAX
   800 000007A5 7E 03                           	JLE	L158
   801 000007A7 89 45 E4                        	MOV	DWORD [-28+EBP],EAX
   802 000007AA                                 L158:
   803 000007AA 83 7F 14 FF                     	CMP	DWORD [20+EDI],-1
   804 000007AE 74 71                           	JE	L210
   805 000007B0 89 CA                           	MOV	EDX,ECX
   806 000007B2 3B 4D E4                        	CMP	ECX,DWORD [-28+EBP]
   807 000007B5 7D 50                           	JGE	L153
   808 000007B7                                 L193:
   809 000007B7 8B 47 10                        	MOV	EAX,DWORD [16+EDI]
   810 000007BA 8B 4D EC                        	MOV	ECX,DWORD [-20+EBP]
   811 000007BD 01 D0                           	ADD	EAX,EDX
   812 000007BF 3B 4D E8                        	CMP	ECX,DWORD [-24+EBP]
   813 000007C2 89 45 C4                        	MOV	DWORD [-60+EBP],EAX
   814 000007C5 7D 3A                           	JGE	L205
   815 000007C7                                 L192:
   816 000007C7 89 D0                           	MOV	EAX,EDX
   817 000007C9 8B 5F 0C                        	MOV	EBX,DWORD [12+EDI]
   818 000007CC 0F AF 47 04                     	IMUL	EAX,DWORD [4+EDI]
   819 000007D0 01 CB                           	ADD	EBX,ECX
   820 000007D2 8B 75 DC                        	MOV	ESI,DWORD [-36+EBP]
   821 000007D5 01 C8                           	ADD	EAX,ECX
   822 000007D7 89 5D C8                        	MOV	DWORD [-56+EBP],EBX
   823 000007DA 0F B6 34 30                     	MOVZX	ESI,BYTE [EAX+ESI*1]
   824 000007DE 3B 77 14                        	CMP	ESI,DWORD [20+EDI]
   825 000007E1 74 18                           	JE	L189
   826 000007E3 8B 45 08                        	MOV	EAX,DWORD [8+EBP]
   827 000007E6 8B 5D C4                        	MOV	EBX,DWORD [-60+EBP]
   828 000007E9 8B 75 C8                        	MOV	ESI,DWORD [-56+EBP]
   829 000007EC 0F AF 58 08                     	IMUL	EBX,DWORD [8+EAX]
   830 000007F0 01 DE                           	ADD	ESI,EBX
   831 000007F2 8A 45 DB                        	MOV	AL,BYTE [-37+EBP]
   832 000007F5 8B 5D D4                        	MOV	EBX,DWORD [-44+EBP]
   833 000007F8 88 04 1E                        	MOV	BYTE [ESI+EBX*1],AL
   834 000007FB                                 L189:
   835 000007FB 41                              	INC	ECX
   836 000007FC 3B 4D E8                        	CMP	ECX,DWORD [-24+EBP]
   837 000007FF 7C C6                           	JL	L192
   838 00000801                                 L205:
   839 00000801 42                              	INC	EDX
   840 00000802 3B 55 E4                        	CMP	EDX,DWORD [-28+EBP]
   841 00000805 7C B0                           	JL	L193
   842 00000807                                 L153:
   843 00000807 8B 45 08                        	MOV	EAX,DWORD [8+EBP]
   844 0000080A FF 45 F0                        	INC	DWORD [-16+EBP]
   845 0000080D 8B 75 F0                        	MOV	ESI,DWORD [-16+EBP]
   846 00000810 3B 70 10                        	CMP	ESI,DWORD [16+EAX]
   847 00000813 0F 8E FFFFFF26                  	JLE	L194
   848 00000819                                 L196:
   849 00000819 83 C4 30                        	ADD	ESP,48
   850 0000081C 5B                              	POP	EBX
   851 0000081D 5E                              	POP	ESI
   852 0000081E 5F                              	POP	EDI
   853 0000081F 5D                              	POP	EBP
   854 00000820 C3                              	RET
   855 00000821                                 L210:
   856 00000821 83 E2 03                        	AND	EDX,3
   857 00000824 75 7F                           	JNE	L160
   858 00000826 F7 45 EC 00000003               	TEST	DWORD [-20+EBP],3
   859 0000082D 75 76                           	JNE	L160
   860 0000082F F7 45 E8 00000003               	TEST	DWORD [-24+EBP],3
   861 00000836 75 6D                           	JNE	L160
   862 00000838 8B 55 EC                        	MOV	EDX,DWORD [-20+EBP]
   863 0000083B 29 55 E8                        	SUB	DWORD [-24+EBP],EDX
   864 0000083E BA 00000004                     	MOV	EDX,4
   865 00000843 89 D3                           	MOV	EBX,EDX
   866 00000845 8B 45 E8                        	MOV	EAX,DWORD [-24+EBP]
   867 00000848 99                              	CDQ
   868 00000849 F7 FB                           	IDIV	EBX
   869 0000084B 89 45 D0                        	MOV	DWORD [-48+EBP],EAX
   870 0000084E 89 CA                           	MOV	EDX,ECX
   871 00000850 0F B6 45 DB                     	MOVZX	EAX,BYTE [-37+EBP]
   872 00000854 89 C6                           	MOV	ESI,EAX
   873 00000856 C1 E6 08                        	SAL	ESI,8
   874 00000859 09 C6                           	OR	ESI,EAX
   875 0000085B C1 E0 10                        	SAL	EAX,16
   876 0000085E 09 C6                           	OR	ESI,EAX
   877 00000860 C1 E0 08                        	SAL	EAX,8
   878 00000863 09 C6                           	OR	ESI,EAX
   879 00000865 3B 4D E4                        	CMP	ECX,DWORD [-28+EBP]
   880 00000868 89 75 E0                        	MOV	DWORD [-32+EBP],ESI
   881 0000086B 7D 9A                           	JGE	L153
   882 0000086D                                 L170:
   883 0000086D 8B 47 10                        	MOV	EAX,DWORD [16+EDI]
   884 00000870 8B 5D 08                        	MOV	EBX,DWORD [8+EBP]
   885 00000873 01 D0                           	ADD	EAX,EDX
   886 00000875 8B 4D EC                        	MOV	ECX,DWORD [-20+EBP]
   887 00000878 0F AF 43 08                     	IMUL	EAX,DWORD [8+EBX]
   888 0000087C 03 4F 0C                        	ADD	ECX,DWORD [12+EDI]
   889 0000087F 89 45 C4                        	MOV	DWORD [-60+EBP],EAX
   890 00000882 01 C8                           	ADD	EAX,ECX
   891 00000884 31 C9                           	XOR	ECX,ECX
   892 00000886 03 45 D4                        	ADD	EAX,DWORD [-44+EBP]
   893 00000889 3B 4D D0                        	CMP	ECX,DWORD [-48+EBP]
   894 0000088C 7D 0C                           	JGE	L199
   895 0000088E                                 L169:
   896 0000088E 8B 75 E0                        	MOV	ESI,DWORD [-32+EBP]
   897 00000891 89 34 88                        	MOV	DWORD [EAX+ECX*4],ESI
   898 00000894 41                              	INC	ECX
   899 00000895 3B 4D D0                        	CMP	ECX,DWORD [-48+EBP]
   900 00000898 7C F4                           	JL	L169
   901 0000089A                                 L199:
   902 0000089A 42                              	INC	EDX
   903 0000089B 3B 55 E4                        	CMP	EDX,DWORD [-28+EBP]
   904 0000089E 7C CD                           	JL	L170
   905 000008A0 E9 FFFFFF62                     	JMP	L153
   906 000008A5                                 L160:
   907 000008A5 89 CA                           	MOV	EDX,ECX
   908 000008A7 3B 4D E4                        	CMP	ECX,DWORD [-28+EBP]
   909 000008AA 0F 8D FFFFFF57                  	JGE	L153
   910 000008B0                                 L181:
   911 000008B0 8B 47 10                        	MOV	EAX,DWORD [16+EDI]
   912 000008B3 8B 4D EC                        	MOV	ECX,DWORD [-20+EBP]
   913 000008B6 01 D0                           	ADD	EAX,EDX
   914 000008B8 3B 4D E8                        	CMP	ECX,DWORD [-24+EBP]
   915 000008BB 89 45 C4                        	MOV	DWORD [-60+EBP],EAX
   916 000008BE 7D 20                           	JGE	L202
   917 000008C0                                 L180:
   918 000008C0 8B 75 08                        	MOV	ESI,DWORD [8+EBP]
   919 000008C3 8B 45 C4                        	MOV	EAX,DWORD [-60+EBP]
   920 000008C6 8B 5F 0C                        	MOV	EBX,DWORD [12+EDI]
   921 000008C9 0F AF 46 08                     	IMUL	EAX,DWORD [8+ESI]
   922 000008CD 01 CB                           	ADD	EBX,ECX
   923 000008CF 8B 75 D4                        	MOV	ESI,DWORD [-44+EBP]
   924 000008D2 01 C3                           	ADD	EBX,EAX
   925 000008D4 41                              	INC	ECX
   926 000008D5 8A 45 DB                        	MOV	AL,BYTE [-37+EBP]
   927 000008D8 88 04 33                        	MOV	BYTE [EBX+ESI*1],AL
   928 000008DB 3B 4D E8                        	CMP	ECX,DWORD [-24+EBP]
   929 000008DE 7C E0                           	JL	L180
   930 000008E0                                 L202:
   931 000008E0 42                              	INC	EDX
   932 000008E1 3B 55 E4                        	CMP	EDX,DWORD [-28+EBP]
   933 000008E4 7C CA                           	JL	L181
   934 000008E6 E9 FFFFFF1C                     	JMP	L153
   935 000008EB                                 L209:
   936 000008EB 31 C9                           	XOR	ECX,ECX
   937 000008ED E9 FFFFFEA2                     	JMP	L156
   938 000008F2                                 L208:
   939 000008F2 C7 45 EC 00000000               	MOV	DWORD [-20+EBP],0
   940 000008F9 E9 FFFFFE8E                     	JMP	L155
   941 000008FE                                 L207:
   942 000008FE C7 45 10 00000000               	MOV	DWORD [16+EBP],0
   943 00000905 E9 FFFFFE07                     	JMP	L148
   944 0000090A                                 L206:
   945 0000090A C7 45 0C 00000000               	MOV	DWORD [12+EBP],0
   946 00000911 E9 FFFFFDF1                     	JMP	L147
   947 00000916                                 	GLOBAL	_sheet_free
   948 00000916                                 _sheet_free:
   949 00000916 55                              	PUSH	EBP
   950 00000917 89 E5                           	MOV	EBP,ESP
   951 00000919 53                              	PUSH	EBX
   952 0000091A 8B 5D 08                        	MOV	EBX,DWORD [8+EBP]
   953 0000091D 83 7B 18 00                     	CMP	DWORD [24+EBX],0
   954 00000921 78 0A                           	JS	L212
   955 00000923 6A FF                           	PUSH	-1
   956 00000925 53                              	PUSH	EBX
   957 00000926 E8 FFFFFB94                     	CALL	_sheet_updown
   958 0000092B 58                              	POP	EAX
   959 0000092C 5A                              	POP	EDX
   960 0000092D                                 L212:
   961 0000092D C7 43 1C 00000000               	MOV	DWORD [28+EBX],0
   962 00000934 8B 5D FC                        	MOV	EBX,DWORD [-4+EBP]
   963 00000937 C9                              	LEAVE
   964 00000938 C3                              	RET
